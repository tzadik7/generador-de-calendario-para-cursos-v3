<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generador de Calendarios - FUNCIONAL</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #4285f4, #34a853);
            min-height: 100vh;
        }
        
        .container {
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        h1 {
            color: #1a73e8;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
            color: #333;
        }
        
        input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            box-sizing: border-box;
        }
        
        input:focus {
            border-color: #1a73e8;
            outline: none;
        }
        
        .btn {
            background: #1a73e8;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin: 10px 5px;
            transition: all 0.3s ease;
        }
        
        .btn:hover {
            background: #1557b0;
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: #34a853;
        }
        
        .btn-secondary:hover {
            background: #2d8f47;
        }
        
        .btn-warning {
            background: #fbbc04;
            color: #333;
        }
        
        .alert {
            padding: 15px;
            margin: 20px 0;
            border-radius: 8px;
            font-weight: bold;
        }
        
        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .calendar-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .calendar-table th,
        .calendar-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        
        .calendar-table th {
            background: #1a73e8;
            color: white;
        }
        
        .calendar-table tr:nth-child(even) {
            background: #f8f9fa;
        }
        
        .calendar-table tr:hover {
            background: #e3f2fd;
        }
        
        .date-col {
            width: 200px;
            font-weight: bold;
        }
        
        .hidden {
            display: none;
        }
        
        .test-section {
            background: #e8f5e8;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 5px solid #28a745;
        }
        
        /* Colores para actividades */
        .mod-1 { background: #ffcdd2; }
        .mod-2 { background: #f8bbd9; }
        .mod-3 { background: #e1bee7; }
        .mod-4 { background: #d1c4e9; }
        .mod-5 { background: #c5cae9; }
        .mod-6 { background: #bbdefb; }
        .mod-7 { background: #b3e5fc; }
        .mod-8 { background: #b2dfdb; }
        .mod-9 { background: #c8e6c9; }
        .mod-10 { background: #dcedc8; }
        .intervention { background: #ff8a65; color: white; font-weight: bold; }
        .workshop { background: #7986cb; color: white; font-weight: bold; }
        .evaluation { background: #81c784; color: white; font-weight: bold; }
        .practice { background: #64b5f6; color: white; font-weight: bold; }
        .induction { background: #ba68c8; color: white; font-weight: bold; }
        .graduation { background: #ffd54f; color: #333; font-weight: bold; text-align: center; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéì Generador de Calendarios M√©dicos</h1>
        
        <!-- SECCI√ìN DE PRUEBA -->
        <div class="test-section">
            <h3>üß™ Prueba de Funcionamiento</h3>
            <button class="btn" onclick="testJS()">üîß Probar JavaScript</button>
            <div id="testResult"></div>
        </div>
        
        <!-- FORMULARIO -->
        <div class="form-group">
            <label for="courseName">üìù Nombre del Curso:</label>
            <input type="text" id="courseName" placeholder="Ej: Curso de Ultrasonido 2025" value="Curso de Prueba">
        </div>
        
        <div class="form-group">
            <label for="startDate">üìÖ Fecha de Inicio:</label>
            <input type="date" id="startDate">
        </div>
        
        <div class="form-group">
            <label for="instructor">üë®‚Äç‚öïÔ∏è Instructor:</label>
            <input type="text" id="instructor" placeholder="Nombre del instructor" value="Dr. Ejemplo">
        </div>
        
        <div style="text-align: center;">
            <button class="btn" onclick="generateCalendar()">üìÖ Generar Calendario</button>
            <button class="btn btn-secondary" onclick="saveCalendar()" id="saveBtn" disabled>üíæ Guardar</button>
            <button class="btn btn-warning" onclick="printCalendar()" id="printBtn" disabled>üñ®Ô∏è Imprimir</button>
        </div>
        
        <div id="alerts"></div>
    </div>
    
    <!-- CALENDARIO -->
    <div class="container hidden" id="calendarContainer">
        <h2 id="calendarTitle">üìÖ Calendario Generado</h2>
        <div id="calendarInfo" style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin-bottom: 20px;"></div>
        <div id="calendarContent"></div>
    </div>

    <script>
        // ==================== VARIABLES GLOBALES ====================
        const courseStructure = [
            // M√≥dulo 1 - Introducci√≥n (8 d√≠as)
            'M√≥dulo 1. Introducci√≥n D1', 'M√≥dulo 1. Introducci√≥n D2', 'M√≥dulo 1. Introducci√≥n D3', 'M√≥dulo 1. Introducci√≥n D4',
            'M√≥dulo 1. Introducci√≥n D5', 'M√≥dulo 1. Introducci√≥n D6', 'M√≥dulo 1. Introducci√≥n D7', 'M√≥dulo 1. Introducci√≥n D8',
            
            // M√≥dulo 2 - Renal (11 d√≠as)
            'M√≥dulo 2. Renal D1', 'M√≥dulo 2. Renal D2', 'M√≥dulo 2. Renal D3', 'M√≥dulo 2. Renal D4', 'M√≥dulo 2. Renal D5',
            'M√≥dulo 2. Renal D6', 'M√≥dulo 2. Renal D7', 'M√≥dulo 2. Renal D8', 'M√≥dulo 2. Renal D9', 'M√≥dulo 2. Renal D10', 'M√≥dulo 2. Renal D11',
            
            '1ra Intervenci√≥n Entrenamiento Continuo',
            
            // M√≥dulo 3 - Genitourinario (14 d√≠as)
            'M√≥dulo 3. Genitourinario D1', 'M√≥dulo 3. Genitourinario D2', 'M√≥dulo 3. Genitourinario D3', 'M√≥dulo 3. Genitourinario D4',
            'M√≥dulo 3. Genitourinario D5', 'M√≥dulo 3. Genitourinario D6', 'M√≥dulo 3. Genitourinario D7', 'M√≥dulo 3. Genitourinario D8',
            'M√≥dulo 3. Genitourinario D9', 'M√≥dulo 3. Genitourinario D10', 'M√≥dulo 3. Genitourinario D11', 'M√≥dulo 3. Genitourinario D12',
            'M√≥dulo 3. Genitourinario D13', 'M√≥dulo 3. Genitourinario D14',
            
            '2da Intervenci√≥n Entrenamiento Continuo',
            
            // M√≥dulo 4 - Mama (23 d√≠as)
            'M√≥dulo 4. Mama D1', 'M√≥dulo 4. Mama D2', 'M√≥dulo 4. Mama D3', 'M√≥dulo 4. Mama D4', 'M√≥dulo 4. Mama D5',
            'M√≥dulo 4. Mama D6', 'M√≥dulo 4. Mama D7', 'M√≥dulo 4. Mama D8', 'M√≥dulo 4. Mama D9', 'M√≥dulo 4. Mama D10',
            'M√≥dulo 4. Mama D11', 'M√≥dulo 4. Mama D12', 'M√≥dulo 4. Mama D13', 'M√≥dulo 4. Mama D14', 'M√≥dulo 4. Mama D15',
            'M√≥dulo 4. Mama D16', 'M√≥dulo 4. Mama D17', 'M√≥dulo 4. Mama D18', 'M√≥dulo 4. Mama D19', 'M√≥dulo 4. Mama D20',
            'M√≥dulo 4. Mama D21', 'M√≥dulo 4. Mama D22', 'M√≥dulo 4. Mama D23',
            
            // M√≥dulo 5 - Abdomen (20 d√≠as)
            'M√≥dulo 5. Abdomen D1', 'M√≥dulo 5. Abdomen D2', 'M√≥dulo 5. Abdomen D3', 'M√≥dulo 5. Abdomen D4', 'M√≥dulo 5. Abdomen D5',
            'M√≥dulo 5. Abdomen D6', 'M√≥dulo 5. Abdomen D7', 'M√≥dulo 5. Abdomen D8', 'M√≥dulo 5. Abdomen D9', 'M√≥dulo 5. Abdomen D10',
            'M√≥dulo 5. Abdomen D11', 'M√≥dulo 5. Abdomen D12', 'M√≥dulo 5. Abdomen D13', 'M√≥dulo 5. Abdomen D14', 'M√≥dulo 5. Abdomen D15',
            'M√≥dulo 5. Abdomen D16', 'M√≥dulo 5. Abdomen D17', 'M√≥dulo 5. Abdomen D18', 'M√≥dulo 5. Abdomen D19', 'M√≥dulo 5. Abdomen D20',
            
            '3ra Intervenci√≥n Entrenamiento Continuo',
            
            // M√≥dulo 6 - Obstetricia (25 d√≠as)
            'M√≥dulo 6. Obstetricia D1', 'M√≥dulo 6. Obstetricia D2', 'M√≥dulo 6. Obstetricia D3', 'M√≥dulo 6. Obstetricia D4', 'M√≥dulo 6. Obstetricia D5',
            'M√≥dulo 6. Obstetricia D6', 'M√≥dulo 6. Obstetricia D7', 'M√≥dulo 6. Obstetricia D8', 'M√≥dulo 6. Obstetricia D9', 'M√≥dulo 6. Obstetricia D10',
            'M√≥dulo 6. Obstetricia D11', 'M√≥dulo 6. Obstetricia D12', 'M√≥dulo 6. Obstetricia D13', 'M√≥dulo 6. Obstetricia D14', 'M√≥dulo 6. Obstetricia D15',
            'M√≥dulo 6. Obstetricia D16', 'M√≥dulo 6. Obstetricia D17', 'M√≥dulo 6. Obstetricia D18', 'M√≥dulo 6. Obstetricia D19', 'M√≥dulo 6. Obstetricia D20',
            'M√≥dulo 6. Obstetricia D21', 'M√≥dulo 6. Obstetricia D22', 'M√≥dulo 6. Obstetricia D23', 'M√≥dulo 6. Obstetricia D24', 'M√≥dulo 6. Obstetricia D25',
            
            '4ta Intervenci√≥n Entrenamiento Continuo',
            'Taller botoneria',
            
            // M√≥dulo 7 - Tejidos blandos (7 d√≠as)
            'M√≥dulo 7. Tejidos blandos D1', 'M√≥dulo 7. Tejidos blandos D2', 'M√≥dulo 7. Tejidos blandos D3', 'M√≥dulo 7. Tejidos blandos D4',
            'M√≥dulo 7. Tejidos blandos D5', 'M√≥dulo 7. Tejidos blandos D6', 'M√≥dulo 7. Tejidos blandos D7',
            
            'Taller de cierre mama D1', 'Taller de cierre mama D2',
            
            // M√≥dulo 8 - Cabeza y cuello (11 d√≠as)
            'M√≥dulo 8. Cabeza y cuello D1', 'M√≥dulo 8. Cabeza y cuello D2', 'M√≥dulo 8. Cabeza y cuello D3', 'M√≥dulo 8. Cabeza y cuello D4',
            'M√≥dulo 8. Cabeza y cuello D5', 'M√≥dulo 8. Cabeza y cuello D6', 'M√≥dulo 8. Cabeza y cuello D7', 'M√≥dulo 8. Cabeza y cuello D8',
            'M√≥dulo 8. Cabeza y cuello D9', 'M√≥dulo 8. Cabeza y cuello D10', 'M√≥dulo 8. Cabeza y cuello D11',
            
            '5ta Intervenci√≥n Entrenamiento Continuo',
            'Curso ACLS',
            
            // M√≥dulo 9 - Correlaci√≥n cl√≠nica (5 d√≠as)
            'M√≥dulo 9. Correlaci√≥n clinica D1', 'M√≥dulo 9. Correlaci√≥n clinica D2', 'M√≥dulo 9. Correlaci√≥n clinica D3',
            'M√≥dulo 9. Correlaci√≥n clinica D4', 'M√≥dulo 9. Correlaci√≥n clinica D5',
            
            // M√≥dulo 10 - Multimodal (2 d√≠as)
            'M√≥dulo 10. Multimodal D1', 'M√≥dulo 10. Multimodal D2',
            
            // Evaluaciones finales
            'Evaluaci√≥n final Entrenamiento Continuo D1', 'Evaluaci√≥n final Entrenamiento Continuo D2',
            
            // Pr√°cticas finales (10 d√≠as)
            'Practicas finales D1', 'Practicas finales D2', 'Practicas finales D3', 'Practicas finales D4', 'Practicas finales D5',
            'Practicas finales D6', 'Practicas finales D7', 'Practicas finales D8', 'Practicas finales D9', 'Practicas finales D10',
            
            // Inducci√≥n y graduaci√≥n
            'Inducci√≥n D1', 'Inducci√≥n D2', 'Inducci√≥n D3', 'Graduaci√≥n'
        ];

        let currentCalendar = null;

        // ==================== FUNCI√ìN DE PRUEBA ====================
        function testJS() {
            console.log('üß™ Prueba de JavaScript iniciada');
            const testDiv = document.getElementById('testResult');
            testDiv.innerHTML = '<div style="color: green; font-weight: bold; margin-top: 10px;">‚úÖ ¬°JavaScript est√° funcionando correctamente!</div>';
            showAlert('‚úÖ JavaScript funciona perfectamente. Puedes generar tu calendario.', 'success');
        }

        // ==================== GENERAR CALENDARIO ====================
        function generateCalendar() {
            console.log('üöÄ Iniciando generaci√≥n de calendario...');
            
            const courseName = document.getElementById('courseName').value.trim();
            const startDate = document.getElementById('startDate').value;
            const instructor = document.getElementById('instructor').value.trim();

            // Validaciones
            if (!courseName) {
                showAlert('‚ùå Por favor ingresa el nombre del curso.', 'error');
                return;
            }

            if (!startDate) {
                showAlert('‚ùå Por favor selecciona la fecha de inicio.', 'error');
                return;
            }

            try {
                console.log('üìÖ Creando horario...');
                const schedule = createSchedule(new Date(startDate));
                
                currentCalendar = {
                    name: courseName,
                    startDate: startDate,
                    instructor: instructor || 'No especificado',
                    schedule: schedule
                };

                console.log('üìä Calendario creado:', currentCalendar);
                displayCalendar();
                
                // Habilitar botones
                document.getElementById('saveBtn').disabled = false;
                document.getElementById('printBtn').disabled = false;
                
                showAlert('‚úÖ ¬°Calendario generado exitosamente!', 'success');
                
            } catch (error) {
                console.error('‚ùå Error:', error);
                showAlert('‚ùå Error al generar calendario: ' + error.message, 'error');
            }
        }

        // ==================== CREAR HORARIO ====================
        function createSchedule(startDate) {
            console.log('üìã Creando horario desde:', startDate);
            
            let schedule = [];
            let currentDate = new Date(startDate);
            let moduleIndex = 0;

            while (moduleIndex < courseStructure.length) {
                // Solo d√≠as h√°biles (lunes a viernes)
                if (currentDate.getDay() >= 1 && currentDate.getDay() <= 5) {
                    const weekOfDiplomado = Math.floor(moduleIndex / 5) + 1;
                    const weekOfYear = getWeekOfYear(currentDate);
                    
                    schedule.push({
                        date: new Date(currentDate),
                        activity: courseStructure[moduleIndex],
                        dayOfWeek: currentDate.getDay(),
                        weekOfDiplomado: weekOfDiplomado,
                        weekOfYear: weekOfYear
                    });
                    moduleIndex++;
                }
                currentDate.setDate(currentDate.getDate() + 1);
            }

            console.log('üîß Aplicando restricciones...');
            return applyConstraints(schedule);
        }

        // ==================== APLICAR RESTRICCIONES ====================
        function applyConstraints(schedule) {
            const adjusted = [...schedule];
            
            // Aplicar restricciones de d√≠as espec√≠ficos
            for (let i = 0; i < adjusted.length; i++) {
                const item = adjusted[i];
                
                // Intervenciones a viernes
                if (item.activity.includes('Intervenci√≥n Entrenamiento Continuo')) {
                    const fridayDate = findNextWeekday(item.date, 5); // 5 = viernes
                    adjusted[i].date = fridayDate;
                    adjusted[i].dayOfWeek = 5;
                    adjusted[i].weekOfYear = getWeekOfYear(fridayDate);
                }
                
                // Inducci√≥n a lunes-martes-mi√©rcoles
                if (item.activity === 'Inducci√≥n D1') {
                    const mondayDate = findNextWeekday(item.date, 1); // 1 = lunes
                    adjusted[i].date = mondayDate;
                    adjusted[i].dayOfWeek = 1;
                    adjusted[i].weekOfYear = getWeekOfYear(mondayDate);
                } else if (item.activity === 'Inducci√≥n D2') {
                    // Encontrar Inducci√≥n D1
                    const inductionD1 = adjusted.find(x => x.activity === 'Inducci√≥n D1');
                    if (inductionD1) {
                        const tuesdayDate = new Date(inductionD1.date);
                        tuesdayDate.setDate(inductionD1.date.getDate() + 1);
                        adjusted[i].date = tuesdayDate;
                        adjusted[i].dayOfWeek = 2;
                        adjusted[i].weekOfYear = getWeekOfYear(tuesdayDate);
                    }
                } else if (item.activity === 'Inducci√≥n D3') {
                    // Encontrar Inducci√≥n D1
                    const inductionD1 = adjusted.find(x => x.activity === 'Inducci√≥n D1');
                    if (inductionD1) {
                        const wednesdayDate = new Date(inductionD1.date);
                        wednesdayDate.setDate(inductionD1.date.getDate() + 2);
                        adjusted[i].date = wednesdayDate;
                        adjusted[i].dayOfWeek = 3;
                        adjusted[i].weekOfYear = getWeekOfYear(wednesdayDate);
                    }
                }
                
                // Graduaci√≥n a jueves (d√≠a despu√©s de Inducci√≥n D3)
                if (item.activity === 'Graduaci√≥n') {
                    const inductionD3 = adjusted.find(x => x.activity === 'Inducci√≥n D3');
                    if (inductionD3) {
                        const thursdayDate = new Date(inductionD3.date);
                        thursdayDate.setDate(inductionD3.date.getDate() + 1);
                        adjusted[i].date = thursdayDate;
                        adjusted[i].dayOfWeek = 4;
                        adjusted[i].weekOfYear = getWeekOfYear(thursdayDate);
                    }
                }
            }

            // Ordenar por fecha
            return adjusted.sort((a, b) => a.date - b.date);
        }

        // ==================== FUNCIONES DE UTILIDAD ====================
        function findNextWeekday(date, targetDay) {
            const result = new Date(date);
            const daysUntilTarget = (targetDay - result.getDay() + 7) % 7;
            if (daysUntilTarget === 0 && result.getDay() !== targetDay) {
                result.setDate(result.getDate() + 7);
            } else {
                result.setDate(result.getDate() + daysUntilTarget);
            }
            return result;
        }

        function getWeekOfYear(date) {
            const start = new Date(date.getFullYear(), 0, 1);
            const days = Math.floor((date - start) / (24 * 60 * 60 * 1000));
            return Math.ceil((days + start.getDay() + 1) / 7);
        }

        function formatDate(date) {
            return date.toLocaleDateString('es-ES', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
        }

        function formatDateShort(date) {
            const days = ['Dom', 'Lun', 'Mar', 'Mi√©', 'Jue', 'Vie', 'S√°b'];
            const months = ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 
                           'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'];
            
            return `${days[date.getDay()]} ${date.getDate()} ${months[date.getMonth()]}`;
        }

        function getActivityClass(activity) {
            if (activity.includes('M√≥dulo 1')) return 'mod-1';
            if (activity.includes('M√≥dulo 2')) return 'mod-2';
            if (activity.includes('M√≥dulo 3')) return 'mod-3';
            if (activity.includes('M√≥dulo 4')) return 'mod-4';
            if (activity.includes('M√≥dulo 5')) return 'mod-5';
            if (activity.includes('M√≥dulo 6')) return 'mod-6';
            if (activity.includes('M√≥dulo 7')) return 'mod-7';
            if (activity.includes('M√≥dulo 8')) return 'mod-8';
            if (activity.includes('M√≥dulo 9')) return 'mod-9';
            if (activity.includes('M√≥dulo 10')) return 'mod-10';
            if (activity.includes('Intervenci√≥n')) return 'intervention';
            if (activity.includes('Taller') || activity.includes('ACLS')) return 'workshop';
            if (activity.includes('Evaluaci√≥n')) return 'evaluation';
            if (activity.includes('Practicas')) return 'practice';
            if (activity.includes('Inducci√≥n')) return 'induction';
            if (activity.includes('Graduaci√≥n')) return 'graduation';
            return '';
        }

        // ==================== MOSTRAR CALENDARIO ====================
        function displayCalendar() {
            console.log('üñ•Ô∏è Mostrando calendario...');
            
            const container = document.getElementById('calendarContainer');
            const title = document.getElementById('calendarTitle');
            const info = document.getElementById('calendarInfo');
            const content = document.getElementById('calendarContent');

            title.textContent = `üìÖ ${currentCalendar.name}`;
            
            const startDate = currentCalendar.schedule[0].date;
            const endDate = currentCalendar.schedule[currentCalendar.schedule.length - 1].date;
            const totalWeeks = Math.ceil(currentCalendar.schedule.length / 5);

            info.innerHTML = `
                <h3>üìä Informaci√≥n del Curso</h3>
                <p><strong>üë®‚Äç‚öïÔ∏è Instructor:</strong> ${currentCalendar.instructor}</p>
                <p><strong>üìÖ Fecha de inicio:</strong> ${formatDate(startDate)}</p>
                <p><strong>üèÅ Fecha de fin:</strong> ${formatDate(endDate)}</p>
                <p><strong>‚è±Ô∏è Duraci√≥n:</strong> ${currentCalendar.schedule.length} d√≠as h√°biles (${totalWeeks} semanas)</p>
                <p><strong>üìå Restricciones aplicadas:</strong></p>
                <ul>
                    <li>üéØ Intervenciones siempre en <strong>viernes</strong></li>
                    <li>üöÄ Inducci√≥n en <strong>lunes-martes-mi√©rcoles</strong> consecutivos</li>
                    <li>üéì Graduaci√≥n en <strong>jueves</strong> (d√≠a despu√©s de inducci√≥n)</li>
                    <li>üö´ Sin solapamientos en eventos especiales</li>
                </ul>
            `;

            // Crear tabla
            const table = document.createElement('table');
            table.className = 'calendar-table';

            // Header
            const headerRow = document.createElement('tr');
            headerRow.innerHTML = `
                <th>üìÖ Fecha</th>
                <th>üìö Actividad</th>
                <th>üìä Semanas</th>
            `;
            table.appendChild(headerRow);

            // Filas de datos
            currentCalendar.schedule.forEach(day => {
                const row = document.createElement('tr');
                row.className = getActivityClass(day.activity);
                
                let activityText = day.activity;
                if (day.activity.includes('Intervenci√≥n Entrenamiento Continuo')) {
                    activityText = `üéØ ${day.activity} (VIERNES)`;
                } else if (day.activity.includes('Evaluaci√≥n')) {
                    activityText = `üìù ${day.activity}`;
                } else if (day.activity.includes('Practicas')) {
                    activityText = `üë©‚Äç‚öïÔ∏è ${day.activity}`;
                }
                
                row.innerHTML = `
                    <td class="date-col">${formatDateShort(day.date)}</td>
                    <td>${activityText}</td>
                    <td>Sem. ${day.weekOfDiplomado} Dip. | Sem. ${day.weekOfYear} A√±o</td>
                `;
                table.appendChild(row);
            });

            content.innerHTML = '';
            content.appendChild(table);
            container.classList.remove('hidden');

            // Scroll suave al calendario
            container.scrollIntoView({ behavior: 'smooth' });
        }

        // ==================== GUARDAR CALENDARIO ====================
        function saveCalendar() {
            if (!currentCalendar) {
                showAlert('‚ùå No hay calendario para guardar.', 'error');
                return;
            }

            try {
                const savedCalendars = JSON.parse(localStorage.getItem('medicalCalendars') || '[]');
                const calendarToSave = {
                    ...currentCalendar,
                    id: Date.now().toString(),
                    createdAt: new Date().toISOString()
                };
                
                savedCalendars.push(calendarToSave);
                localStorage.setItem('medicalCalendars', JSON.stringify(savedCalendars));
                
                showAlert('‚úÖ ¬°Calendario guardado exitosamente!', 'success');
                console.log('üíæ Calendario guardado:', calendarToSave);
                
            } catch (error) {
                console.error('‚ùå Error al guardar:', error);
                showAlert('‚ùå Error al guardar el calendario.', 'error');
            }
        }

        // ==================== IMPRIMIR CALENDARIO ====================
        function printCalendar() {
            if (!currentCalendar) {
                showAlert('‚ùå No hay calendario para imprimir.', 'error');
                return;
            }
            
            showAlert('üñ®Ô∏è Abriendo ventana de impresi√≥n...', 'success');
            setTimeout(() => {
                window.print();
            }, 500);
        }

        // ==================== MOSTRAR ALERTAS ====================
        function showAlert(message, type) {
            console.log(`üì¢ Alerta [${type}]:`, message);
            
            const container = document.getElementById('alerts');
            const alert = document.createElement('div');
            alert.className = `alert alert-${type}`;
            alert.textContent = message;
            
            container.innerHTML = '';
            container.appendChild(alert);
            
            // Auto-ocultar despu√©s de 5 segundos
            setTimeout(() => {
                if (container.contains(alert)) {
                    container.removeChild(alert);
                }
            }, 5000);
        }

        // ==================== INICIALIZACI√ìN ====================
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Aplicaci√≥n inicializada');
            
            // Establecer fecha de hoy
            const today = new Date();
            const dateString = today.toISOString().split('T')[0];
            document.getElementById('startDate').value = dateString;
            
            // Mensaje de bienvenida
            showAlert('üëã ¬°Bienvenido! Presiona "Probar JavaScript" para verificar que todo funciona.', 'success');
            
            // Auto-test despu√©s de 2 segundos
            setTimeout(() => {
                console.log('üîÑ Ejecutando auto-test...');
                const testDiv = document.getElementById('testResult');
                testDiv.innerHTML = '<div style="color: blue; margin-top: 10px;">üîÑ Auto-test ejecutado: JavaScript cargado correctamente</div>';
            }, 2000);
        });

        // ==================== MANEJO DE ERRORES GLOBALES ====================
        window.addEventListener('error', function(e) {
            console.error('üí• Error global:', e.error);
            showAlert('‚ö†Ô∏è Se detect√≥ un error. Revisa la consola para m√°s detalles.', 'error');
        });

        // ==================== FUNCIONES DE DEBUG ====================
        function debugInfo() {
            console.log('üêõ Informaci√≥n de debug:');
            console.log('- courseStructure length:', courseStructure.length);
            console.log('- currentCalendar:', currentCalendar);
            console.log('- Local storage:', localStorage.getItem('medicalCalendars'));
        }

        // Hacer funciones globales para debug
        window.debugInfo = debugInfo;
        window.testJS = testJS;
        window.generateCalendar = generateCalendar;
        window.saveCalendar = saveCalendar;
        window.printCalendar = printCalendar;

        console.log('‚úÖ Todas las funciones han sido cargadas correctamente');
    </script>
</body>
</html>activity.includes('Inducci√≥n')) {
                    const dayNames = ['', 'LUNES', 'MARTES', 'MI√âRCOLES'];
                    activityText = `üöÄ ${day.activity} (${dayNames[day.dayOfWeek]})`;
                } else if (day.activity.includes('Graduaci√≥n')) {
                    activityText = `üéì ${day.activity} (JUEVES)`;
                } else if (day.activity.includes('Taller')) {
                    activityText = `üîß ${day.activity}`;
                } else if (day.activity.includes('ACLS')) {
                    activityText = `üöë ${day.activity}`;
                } else if (day.
